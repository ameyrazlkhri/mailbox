<!DOCTYPE html>
<html>
<head>
  <title>Mailbox ðŸ’Œ</title>
  <link href="https://fonts.googleapis.com/css2?family=Cedarville+Cursive&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px;
      background: linear-gradient(135deg, #ffe6f0, #ffcce6);
    }

    h1 {
      font-family: 'Cedarville Cursive', cursive;
      font-size: 48px;
      color: #ff6b81;
      margin-bottom: 10px;
    }

    #letterCount {
      font-size: 20px;
      color: #d97c6a;
      margin-bottom: 20px;
    }

    #mailbox {
      padding: 20px;
      min-height: 250px;
      background: rgba(255,255,255,0.7);
      border-radius: 20px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
    }

    .envelope {
      display: flex;
      width: 70px;
      height: 50px;
      margin: 10px;
      border-radius: 12px;
      cursor: pointer;
      color: white;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 24px;
      transition: transform 0.3s ease;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.2);
      position: relative;
    }

    .envelope:hover {
      transform: translateY(-10px) rotate(-5deg) scale(1.1);
    }

    #letterDisplay {
      font-family: 'Cedarville Cursive', cursive;
      font-size: 20px;
      line-height: 1.6;
      background: #fff0f5;
      padding: 25px;
      border-radius: 15px;
      border: 2px solid #d97c6a;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
      display: none;
      width: 320px;
      margin: 30px auto 0 auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      color: inherit;
    }

    #clearBtn {
      padding: 12px 25px;
      background: #ff6b81;
      color: white;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 20px;
      transition: background 0.2s, transform 0.2s;
    }

    #clearBtn:hover {
      background: #ff4c61;
      transform: scale(1.05);
    }

    .heart {
      position: absolute;
      width: 12px;
      height: 12px;
      background: red;
      transform: rotate(45deg);
      border-radius: 50%;
      pointer-events: none;
      animation: float 2s ease-out forwards;
    }

    .heart::before,
    .heart::after {
      content: '';
      position: absolute;
      width: 12px;
      height: 12px;
      background: red;
      border-radius: 50%;
    }
    .heart::before { top: -6px; left: 0; }
    .heart::after { top: 0; left: -6px; }

    @keyframes float {
      0% { transform: translateY(0) rotate(45deg); opacity: 1; }
      100% { transform: translateY(-100px) rotate(45deg); opacity: 0; }
    }
  </style>
</head>
<body>

<h1>ðŸ“¬ Your Mailbox</h1>
<div id="letterCount"></div>
<button id="clearBtn">Clear Inbox</button>
<div id="mailbox"></div>
<div id="letterDisplay"></div>

<!-- Firebase SDKs -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getDatabase, ref, onChildAdded, remove } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

  // --- Your Firebase Config ---
  const firebaseConfig = {
    apiKey: "AIzaSyBsAlAk1b6XWckFWyUb4xWnRYLGVGbl4vI",
    authDomain: "my-mailbox-1e0f1.firebaseapp.com",
    databaseURL: "https://my-mailbox-1e0f1-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "my-mailbox-1e0f1",
    storageBucket: "my-mailbox-1e0f1.firebasestorage.app",
    messagingSenderId: "606445250262",
    appId: "1:606445250262:web:3709008dea85f439210b77",
    measurementId: "G-QLG99DGX9E"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const lettersRef = ref(db, 'letters');

  const mailbox = document.getElementById('mailbox');
  const letterDisplay = document.getElementById('letterDisplay');
  const letterCount = document.getElementById('letterCount');
  const clearBtn = document.getElementById('clearBtn');

  const colors = { Pink: '#ffb6c1', Blue: '#add8e6', Beige: '#f5f5dc' };

  let letters = [];

  function addEnvelope(letter) {
    const env = document.createElement('div');
    env.className = 'envelope';
    env.style.background = colors[letter.color] || '#ffb6c1';
    env.textContent = letter.sticker || "âœ‰ï¸";
    env.addEventListener('click', () => {
      letterDisplay.style.display = 'block';
      letterDisplay.style.color = letter.textColor || '#d97c6a';
      letterDisplay.textContent = letter.text;

      // Hearts pop out
      for (let i = 0; i < 5; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.style.left = env.offsetLeft + 20 + Math.random()*20 + 'px';
        heart.style.top = env.offsetTop - 10 + 'px';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 2000 + Math.random()*500);
      }
    });
    mailbox.appendChild(env);
  }

  function updateCount() {
    letterCount.textContent = `You have ${letters.length} letters in your mailbox ðŸ’Œ`;
  }

  // Listen for new letters in real-time
  onChildAdded(lettersRef, (snapshot) => {
    const letter = snapshot.val();
    letters.push(letter);
    addEnvelope(letter);
    updateCount();
  });

  // Clear all letters
  clearBtn.addEventListener('click', () => {
    if(confirm('Are you sure you want to clear all letters?')) {
      remove(lettersRef).then(() => {
        letters = [];
        mailbox.innerHTML = '';
        letterDisplay.style.display = 'none';
        updateCount();
        alert('Inbox cleared!');
      }).catch(err => alert('Error clearing inbox: ' + err));
    }
  });
</script>

</body>
</html>

